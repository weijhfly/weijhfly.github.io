(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{507:function(e,t,s){"use strict";t.a={newsTypeFilter:function(e){return 0===e?"自建新闻":"新闻链接"},newsStatusFilter:function(e){return 0===e?"草稿":1===e?"已提交":"已发布"},createTimeFilter:function(e){return 0===e?"一星期内":1===e?"一个月内":2===e?"三个月内":"半年内"},auditStatusFilter:function(e){return 1===e?"审核通过":2===e?"审核未通过":"待审核"},delFlagFilter:function(e){return 0===e?"是":"否"}}},519:function(e,t,s){"use strict";s.d(t,"d",(function(){return i})),s.d(t,"c",(function(){return r})),s.d(t,"a",(function(){return a})),s.d(t,"b",(function(){return l}));var i=[{value:0,label:"自建新闻"},{value:1,label:"外链新闻"}],r=[{value:0,label:"草稿"},{value:1,label:"已提交"},{value:2,label:"已发布"}],a=[{value:0,label:"待审核"},{value:1,label:"审核通过"},{value:2,label:"审核未通过"}],l=[{value:0,label:"一星期内"},{value:1,label:"一个月内"},{value:2,label:"三个月内"},{value:3,label:"半年内"}]},712:function(e,t,s){},713:function(e,t,s){},714:function(e,t,s){},715:function(e,t,s){},716:function(e,t,s){},717:function(e,t,s){},816:function(e,t,s){e.exports=s(817)},817:function(e,t,s){s(818),e.exports=s(16).Object.entries},818:function(e,t,s){var i=s(18),r=s(819)(!0);i(i.S,"Object",{entries:function(e){return r(e)}})},819:function(e,t,s){var i=s(28),r=s(58),a=s(51),l=s(73).f;e.exports=function(e){return function(t){for(var s,n=a(t),o=r(n),u=o.length,c=0,p=[];u>c;)s=o[c++],i&&!l.call(n,s)||p.push(e?[s,n[s]]:n[s]);return p}}},910:function(e,t,s){"use strict";s(712)},911:function(e,t,s){"use strict";s(713)},912:function(e,t,s){"use strict";s(714)},913:function(e,t,s){"use strict";s(715)},914:function(e,t,s){"use strict";s(716)},915:function(e,t,s){"use strict";s(717)},927:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"index-news"},[s("div",{staticClass:"radio"},[s("el-radio-group",{attrs:{size:"medium"},model:{value:e.pageType,callback:function(t){e.pageType=t},expression:"pageType"}},[s("el-radio-button",{attrs:{label:"新闻列表"}}),e._v(" "),s("el-radio-button",{attrs:{label:"新闻类别"}})],1)],1),e._v(" "),s("div",{staticClass:"query-content"},[s("div",{staticClass:"query"},[s("div",{staticClass:"title"},[e._v("查询：")]),e._v(" "),s("el-form",{ref:"ruleForm",staticClass:"query-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"所属商圈",prop:"businessId"}},[s("el-select",{attrs:{placeholder:"请选择所属商圈"},on:{change:e.onChangeBusiness},model:{value:e.ruleForm.businessId,callback:function(t){e.$set(e.ruleForm,"businessId",t)},expression:"ruleForm.businessId"}},e._l(e.businessSet,(function(e,t){return s("el-option",{key:"business-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"所属项目",prop:"projectId"}},[s("el-select",{attrs:{placeholder:"请选择所属项目"},model:{value:e.ruleForm.projectId,callback:function(t){e.$set(e.ruleForm,"projectId",t)},expression:"ruleForm.projectId"}},e._l(e.projectSet,(function(e,t){return s("el-option",{key:"project-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻类型",prop:"newsType"}},[s("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:e.ruleForm.newsType,callback:function(t){e.$set(e.ruleForm,"newsType",t)},expression:"ruleForm.newsType"}},e._l(e.newsTypeSet,(function(e,t){return s("el-option",{key:"newsType-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题",prop:"newsTitle"}},[s("el-input",{attrs:{placeholder:"请输入新闻标题"},model:{value:e.ruleForm.newsTitle,callback:function(t){e.$set(e.ruleForm,"newsTitle",t)},expression:"ruleForm.newsTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[s("el-select",{attrs:{placeholder:"请选择创建时间"},model:{value:e.ruleForm.createTime,callback:function(t){e.$set(e.ruleForm,"createTime",t)},expression:"ruleForm.createTime"}},e._l(e.createTimeSet,(function(e,t){return s("el-option",{key:"createTime-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻状态",prop:"newsStatus"}},[s("el-select",{attrs:{placeholder:"请选择新闻状态"},model:{value:e.ruleForm.newsStatus,callback:function(t){e.$set(e.ruleForm,"newsStatus",t)},expression:"ruleForm.newsStatus"}},e._l(e.newsStatusSet,(function(e,t){return s("el-option",{key:"newsStatus-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{staticClass:"btn-area"},[s("el-button",{attrs:{type:"primary"},on:{click:e.conditionQuery}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),s("div",{staticClass:"list"},[s("div",{staticClass:"title-area"},[s("div",{staticClass:"title"},[e._v("新闻列表：")]),e._v(" "),s("div",{staticClass:"btns"},[s("el-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("添加")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onBatchDel}},[e._v("删除")])],1)]),e._v(" "),s("div",{staticClass:"table-area"},[s("el-table",{ref:"newsTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.data,"max-height":"500"},on:{"selection-change":e.onSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"businessId",label:"所属商圈",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"projectId",label:"所属项目",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"newsType",label:"新闻类型",width:""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsTypeFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"newsTitle",label:"新闻标题",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"",label:"有效时间段",width:""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(s.publishTimeStart)+" 至 "+e._s(s.publishTimeEnd))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"newsStatus",label:"新闻状态",width:""},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsStatusFilter")(s.newsStatus)))]}}])}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onEdit(i)}}},[e._v("编辑")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onDel(i)}}},[e._v("删除")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onDetails(i)}}},[e._v("查看")])]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.meta.pageNo,"page-sizes":[10,20,50,100],"page-size":e.meta.pageSize,total:e.meta.total,layout:"prev, pager, next, jumper, sizes, total"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]),e._v(" "),s("oper-dialog",{attrs:{title:e.operType+"新闻",rowObj:e.rowObj,storeList:e.storeList,operType:e.operType,visible:e.showOperDialog},on:{"update:visible":function(t){e.showOperDialog=t},submitForm:e.submitForm}}),e._v(" "),s("details-dialog",{attrs:{title:e.operType+"新闻",rowObj:e.rowObj,storeList:e.storeList,operType:e.operType,visible:e.showDetailsDialog},on:{"update:visible":function(t){e.showDetailsDialog=t}}})],1)};i._withStripped=!0;var r=s(74),a=s.n(r),l=s(23),n=s.n(l),o=s(816),u=s.n(o),c=s(6),p=s.n(c),m=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"oper-dialog",attrs:{title:e.title,width:"1000px",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.close,open:e.open}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"所属商圈/项目",prop:""}},[s("div",[e._v("businessSet - "+e._s(e.businessSet))]),e._v(" "),s("div",[e._v("projectSet - "+e._s(e.projectSet))]),e._v(" "),s("div",[e._v("projectIds - "+e._s(e.projectIds))]),e._v(" "),s("div",[e._v("idTree - "+e._s(e.idTree))]),e._v(" "),s("div",{staticClass:"wrapper"},[s("el-radio-group",{staticClass:"business-area",on:{change:e.onChangeBusiness},model:{value:e.businessId,callback:function(t){e.businessId=t},expression:"businessId"}},e._l(e.businessSet,(function(t,i){return s("el-radio",{key:"business"+i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1),e._v(" "),s("el-checkbox-group",{staticClass:"project-area",on:{change:e.onChangeProject},model:{value:e.projectIds,callback:function(t){e.projectIds=t},expression:"projectIds"}},e._l(e.projectSet,(function(t,i){return s("el-checkbox",{key:"project"+i,attrs:{label:t.value}},[e._v(e._s(t.label))])})),1)],1)]),e._v(" "),s("el-form-item",{attrs:{label:"新闻类型",prop:"newsType"}},[s("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:e.ruleForm.newsType,callback:function(t){e.$set(e.ruleForm,"newsType",t)},expression:"ruleForm.newsType"}},e._l(e.newsTypeSet,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题",prop:"newsTitle"}},[s("el-input",{attrs:{placeholder:"请填写新闻标题",autocomplete:"off"},model:{value:e.ruleForm.newsTitle,callback:function(t){e.$set(e.ruleForm,"newsTitle",t)},expression:"ruleForm.newsTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"列表图片",prop:"newsImg"}},[e.ruleForm.newsImg?s("div",{staticClass:"previewPic"},[s("img",{attrs:{src:e.ruleForm.newsImg,alt:""}})]):e._e(),e._v(" "),s("div",{staticClass:"upload-btn",attrs:{type:"primary"},on:{click:function(t){e.showChooseImageDialog=!0}}},[s("span",{staticClass:"plus"},[e._v("+")]),e._v(" "),s("span",{staticClass:"letter"},[e._v("Upload")])]),e._v(" "),s("div",{staticClass:"tips"},[e._v("（建议尺寸300px*200px）")])]),e._v(" "),s("el-form-item",{attrs:{label:"有效时间段",prop:"publishTimeEnd"}},[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.onChangeValidTimeZone},model:{value:e.validTimeZone,callback:function(t){e.validTimeZone=t},expression:"validTimeZone"}})],1),e._v(" "),0===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻内容",prop:"newsContent"}},[s("umeditor",{ref:"umeditor",attrs:{id:"111"},model:{value:e.ruleForm.newsContent,callback:function(t){e.$set(e.ruleForm,"newsContent",t)},expression:"ruleForm.newsContent"}})],1):e._e(),e._v(" "),1===e.ruleForm.newsType?s("el-form-item",{staticClass:"newsUrl",attrs:{label:"新闻URL",prop:"newsUrl"}},[s("el-input",{attrs:{placeholder:"请填写新闻URL（仅支持公众号URL）",autocomplete:"off"},model:{value:e.ruleForm.newsUrl,callback:function(t){e.$set(e.ruleForm,"newsUrl",t)},expression:"ruleForm.newsUrl"}})],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.preview}},[e._v("预 览")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.storeAsDraft}},[e._v("存为草稿")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("发 布")])],1)],1),e._v(" "),e.showChooseImageDialog?s("images-picker",{attrs:{visible:e.showChooseImageDialog,multiple:!1,limit:1},on:{"update:visible":function(t){e.showChooseImageDialog=t},cancel:function(t){e.showChooseImageDialog=!1},picked:e.onPickedImage}}):e._e()],1)};m._withStripped=!0;var d=s(499),v=s.n(d),f=s(724),h=s(24),b=s(501),w=s(507),g=s(519),_={name:"OperDialog",mixins:[],components:{umeditor:f.a,ImagesPicker:h.a},props:{title:{type:String,default:"标题"},operType:{type:String,default:"新增"},rowObj:{type:Object,default:function(){}},storeList:{type:Array,default:function(){return[]}},visible:{type:Boolean,default:!1}},data:function(){return{idTree:{},businessId:"",projectIds:[],validTimeZone:[],ruleForm:this.getInitialForm(),isLoading:!1,showChooseImageDialog:!1,businessSet:[],projectSet:[],newsTypeSet:g.d,auditStatusSet:g.a,createTimeSet:g.b,rules:{storeIds:[{required:!0,message:"请选择项目",trigger:"change"}],newsType:[{required:!0,message:"请选择新闻类型",trigger:"change"}],newsTitle:[{required:!0,message:"请填写新闻标题",trigger:"blur"}],newsImg:[{required:!0,message:"请选择列表图片",trigger:"change"}],publishTimeEnd:[{required:!0,message:"请选择有效时间段",trigger:"change"}],newsContent:[{required:!0,message:"请编辑新闻内容",trigger:"blur"}],newsUrl:[{required:!0,message:"请填写新闻URL",trigger:"blur"}]}}},created:function(){},mounted:function(){},watch:{"ruleForm.newsType":{immediate:!0,handler:function(e){}},businessId:{immediate:!0,handler:function(e){}}},filters:p()({},w.a),computed:{show:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{arr2Obj:function(e){var t={};return e.forEach((function(e){t[e.businessDistrictId]=[],e.projectDTOS.forEach((function(s){t[e.businessDistrictId].push(Number(s.projectId))}))})),t},getInitialForm:function(){return{storeIds:"",newsType:"",newsTitle:"",newsImg:"",publishTimeStart:"",publishTimeEnd:"",newsContent:"",newsUrl:""}},getBusinessSet:function(){var e=this.storeList;if(!e.length)return[];var t=e.map((function(e){return{value:e.id,label:e.name}}));this.businessSet=t},onChangeBusiness:function(e){var t=this.storeList.find((function(t){return t.id===e}));t&&t.childList&&t.childList.length?this.projectSet=t.childList.map((function(e){return{value:e.id,label:e.name}})):this.projectSet=[],this.idTree[e]?this.projectIds=this.idTree[e]:(this.idTree[e]=[],this.projectIds=[])},onChangeProject:function(e){var t,s=this.businessId;this.idTree[s].length=0,(t=this.idTree[s]).push.apply(t,this.projectIds),this.$forceUpdate()},onChangeValidTimeZone:function(e){var t=new Date(e[0]),s=new Date(e[1]);this.ruleForm.publishTimeStart=v()(t).format("YYYY-MM-DD hh:mm:ss"),this.ruleForm.publishTimeEnd=v()(s).format("YYYY-MM-DD hh:mm:ss")},close:function(){this.$refs.ruleForm.clearValidate(),this.ruleForm=this.getInitialForm(),this.show=!1},open:function(){var e=this;if(this.getBusinessSet(),"修改"===this.operType){var t={id:this.rowObj.id,platformEnterprise:"0"};b.a.getDetailsNews(t).done((function(t){t.data&&(e.ruleForm=t.data);var s=e.ruleForm,i=s.publishTimeStart,r=s.publishTimeEnd,a=new Date(i),l=new Date(r);e.validTimeZone=[a,l],e.idTree=e.arr2Obj(e.ruleForm.businessDistrictDTOS)})).always((function(){e.loading=!1}))}},confirm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.ruleForm.newsStatus=2;var s={form:e.ruleForm,idTree:e.idTree};e.$emit("submitForm",s),e.show=!1}))},preview:function(){},storeAsDraft:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.ruleForm.newsStatus=0;var s={form:e.ruleForm,idTree:e.idTree};e.$emit("submitForm",s),e.show=!1}))},onPickedImage:function(e){e&&(this.ruleForm.newsImg=e.imgUrl),this.showChooseImageDialog=!1}}},T=(s(910),s(1)),y=Object(T.a)(_,m,[],!1,null,"01703b96",null);y.options.__file="src/views/news-mgr-p/index-news/components/OperDialog/index.vue";var F=y.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"details-dialog",attrs:{title:e.title,width:"1000px",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.close,open:e.open}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("div",[e._v("ruleForm.businessDistrictDTOS - "+e._s(e.ruleForm.businessDistrictDTOS))]),e._v(" "),s("div",[e._v("storeList - "+e._s(e.storeList))]),e._v(" "),s("el-form-item",{attrs:{label:"所属商圈：",prop:"businessId"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.businessId))])]),e._v(" "),s("el-form-item",{attrs:{label:"所属项目：",prop:"projectId"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.projectId))])]),e._v(" "),s("el-form-item",{attrs:{label:"新闻类型：",prop:"newsType"}},[s("div",{staticClass:"item"},[e._v(e._s(e._f("newsTypeFilter")(e.ruleForm.newsType)))])]),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题：",prop:"newsTitle"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.newsTitle))])]),e._v(" "),s("el-form-item",{attrs:{label:"列表图片：",prop:"newsImg"}},[s("div",{staticClass:"previewPic"},[s("img",{attrs:{src:e.ruleForm.newsImg,alt:""}})]),e._v(" "),s("div",{staticClass:"tips"},[e._v("（尺寸300px*200px）")])]),e._v(" "),s("el-form-item",{attrs:{label:"有效时间段：",prop:"publishTimeEnd"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.publishTimeStart)+" 至 "+e._s(e.ruleForm.publishTimeEnd))])]),e._v(" "),0===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻内容：",prop:"newsContent"}},[s("div",{domProps:{innerHTML:e._s(e.ruleForm.newsContent)}},[e._v(e._s(e.ruleForm.newsContent))])]):e._e(),e._v(" "),1===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻URL：",prop:"newsUrl"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.newsUrl))])]):e._e()],1),e._v(" "),s("div",{staticClass:"approvalRecords"},[s("div",{staticClass:"title"},[e._v("审批记录：")]),e._v(" "),s("div",{staticClass:"table-area"},[s("el-table",{ref:"newsTable",staticStyle:{width:"100%"},attrs:{data:e.ruleForm.memHomeNewsAuditDOList||[],"max-height":"300"}},[s("el-table-column",{attrs:{prop:"newsType",label:"新闻类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsTypeFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"newsTitle",label:"新闻标题",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"submitTime",label:"提交时间",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"auditTime",label:"审批时间",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"auditStatus",label:"审批结果",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("auditStatusFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"auditRemark",label:"理由",width:""}})],1)],1)])],1)],1)};S._withStripped=!0;var D={name:"DetailsDialog",mixins:[],components:{},props:{title:{type:String,default:"标题"},operType:{type:String,default:"新增"},rowObj:{type:Object,default:function(){}},storeList:{type:Array,default:function(){return[]}},visible:{type:Boolean,default:!1}},data:function(){return{ruleForm:this.getInitialForm(),isLoading:!1,approvalTableData:[{newsType:0,newsTitle:"newsTitle1",submitTime:"2020-10-10",auditTime:"2020-10-10",auditStatus:"auditStatus1",auditRemark:"reason1"},{newsType:1,newsTitle:"newsTitle22",submitTime:"2020-11-11",auditTime:"2020-11-11",auditStatus:"auditStatus22",auditRemark:"reason22"}]}},created:function(){},mounted:function(){},filters:p()({},w.a),computed:{show:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{getInitialForm:function(){return{businessId:"",projectId:"",newsType:"",newsTitle:"",publishTimeStart:"",publishTimeEnd:"",newsImg:"",createTime:"",newsStatus:"",newsContent:"",newsUrl:"",memHomeNewsAuditDOList:[]}},close:function(){this.$refs.ruleForm.clearValidate(),this.ruleForm=this.getInitialForm(),this.show=!1},open:function(){var e=this;if("查看"===this.operType){var t={id:this.rowObj.id,platformEnterprise:"0"};b.a.getDetailsNews(t).done((function(t){t.data&&(e.ruleForm=t.data)})).always((function(){e.loading=!1}))}}}},C=(s(911),Object(T.a)(D,S,[],!1,null,"6b7d48e1",null));C.options.__file="src/views/news-mgr-p/index-news/components/DetailsDialog/index.vue";var k=C.exports,x={name:"IndexNews",mixins:[s(520).a],components:{OperDialog:F,DetailsDialog:k},props:{},data:function(){return{storeList:[],pageType:"新闻列表",businessSet:[],projectSet:[],newsTypeSet:g.d,newsStatusSet:g.c,auditStatusSet:g.a,createTimeSet:g.b,ruleForm:{businessId:"",projectId:"",newsType:"",newsTitle:"",createTime:"",newsStatus:""},rules:{},showOperDialog:!1,showDetailsDialog:!1,selection:[]}},mounted:function(){this.fetchData(),this.fetchStoreData()},watch:{pageType:{immediate:!0,handler:function(e){}}},filters:p()({},w.a),computed:{},methods:{obj2Arr:function(e){for(var t=[],s=0,i=u()(e);s<i.length;s++){var r=i[s],a=r[0],l=r[1];l.length&&function(){var e={};e.businessDistrictId=a+"",e.projectDTOS=[],l.forEach((function(t){var s={projectId:t+""};e.projectDTOS.push(s)})),t.push(e)}()}return t},formatObj:function(e){for(var t=JSON.parse(n()(e||null)),s=0,i=a()(t);s<i.length;s++){var r=i[s];void 0!==t[r]&&null!==t[r]&&""!==t[r]||delete t[r]}return t},fetchData:function(){var e=this;this.loading=!0,this.params.platformEnterprise="0",b.a.getNewsList(this.params).done((function(t){t.data?e.tableData=t.data:e.tableData.data=[]})).always((function(){e.loading=!1}))},conditionQuery:function(){var e=p()({},this.params,this.ruleForm);this.params=this.formatObj(e),this.fetchData()},fetchStoreData:function(){var e=this;b.a.getStoreList({queryChildBuzType:2}).done((function(t){e.storeList=t.data,e.getBusinessSet()})).always((function(){}))},getBusinessSet:function(){this.businessSet=this.storeList.map((function(e){return{label:e.name,value:e.id}}))},getProjectSet:function(){var e=this,t=this.storeList.find((function(t){return t.id===e.ruleForm.businessId}));t&&t.childList&&t.childList.length?this.projectSet=t.childList.map((function(e){return{value:e.id,label:e.name}})):this.projectSet=[]},onChangeBusiness:function(){this.getProjectSet()},reset:function(){this.$refs.ruleForm.resetFields(),this.conditionQuery()},onSelectionChange:function(e){this.selection=e},onAdd:function(){this.operType="新增",this.rowObj=null,this.showOperDialog=!0},onEdit:function(e){this.operType="修改",this.rowObj=e,this.showOperDialog=!0},onBatchDel:function(){var e=this;this.selection.length?this.$confirm("即将删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={idList:[]};e.selection.forEach((function(e){t.idList.push(e.id)})),b.a.delNews(t).done((function(t){e.fetchData(),e.$message({type:"success",message:"批量删除成功!"})})).always((function(){}))})).catch((function(){e.$message({type:"info",message:"已取消批量删除"})})):this.$message.info("请选择至少一条数据")},onDel:function(e){var t=this;this.$confirm("即将删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s={idList:[]};s.idList.push(e.id),b.a.delNews(s).done((function(e){t.fetchData(),t.$message({type:"success",message:"删除成功!"})})).always((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},onDetails:function(e){this.operType="查看",this.rowObj=e,this.showDetailsDialog=!0},submitForm:function(e){var t=this,s=e.form,i=e.idTree,r=this.obj2Arr(i),a=JSON.parse(n()(s));a.platformEnterprise="0",a.epId="123",a.businessDistrictDTOS=r,delete a.businessId,delete a.projectId,"新增"===this.operType?b.a.addNews(a).done((function(e){t.fetchData(),t.$message({type:"success",message:"新增成功!"})})).always((function(){})):"修改"===this.operType&&b.a.updataNews(a).done((function(e){t.fetchData(),t.$message({type:"success",message:"修改成功!"})})).always((function(){}))}}},j=(s(912),Object(T.a)(x,i,[],!1,null,"3c37bed6",null));j.options.__file="src/views/news-mgr-p/index-news/index.vue";t.default=j.exports},928:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"approval-news"},[s("div",{staticClass:"query-content"},[s("div",{staticClass:"query"},[s("div",{staticClass:"title"},[e._v("查询：")]),e._v(" "),s("el-form",{ref:"ruleForm",staticClass:"query-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"新闻类型",prop:"newsType"}},[s("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:e.ruleForm.newsType,callback:function(t){e.$set(e.ruleForm,"newsType",t)},expression:"ruleForm.newsType"}},e._l(e.newsTypeSet,(function(e,t){return s("el-option",{key:"newsType-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题",prop:"newsTitle"}},[s("el-input",{attrs:{placeholder:"请输入新闻标题"},model:{value:e.ruleForm.newsTitle,callback:function(t){e.$set(e.ruleForm,"newsTitle",t)},expression:"ruleForm.newsTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"企业名称",prop:"enterpriseName"}},[s("el-input",{attrs:{placeholder:"请输入企业名称"},model:{value:e.ruleForm.enterpriseName,callback:function(t){e.$set(e.ruleForm,"enterpriseName",t)},expression:"ruleForm.enterpriseName"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[s("el-select",{attrs:{placeholder:"请选择创建时间"},model:{value:e.ruleForm.createTime,callback:function(t){e.$set(e.ruleForm,"createTime",t)},expression:"ruleForm.createTime"}},e._l(e.createTimeSet,(function(e,t){return s("el-option",{key:"createTime-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"审核状态",prop:"auditStatus"}},[s("el-select",{attrs:{placeholder:"请选择审核状态"},model:{value:e.ruleForm.auditStatus,callback:function(t){e.$set(e.ruleForm,"auditStatus",t)},expression:"ruleForm.auditStatus"}},e._l(e.auditStatusSet,(function(e,t){return s("el-option",{key:"auditStatus-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{staticClass:"btn-area"},[s("el-button",{attrs:{type:"primary"},on:{click:e.conditionQuery}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),s("div",{staticClass:"list"},[e._m(0),e._v(" "),s("div",{staticClass:"table-area"},[s("el-table",{ref:"newsTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.data,"max-height":"500"}},[s("el-table-column",{attrs:{prop:"enterpriseName",label:"所属企业",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"newsType",label:"新闻类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsTypeFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"newsTitle",label:"新闻标题",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"",label:"有效时间段",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(s.publishTimeStart)+" 至 "+e._s(s.publishTimeEnd))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"auditStatus",label:"审核状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("auditStatusFilter")(s.auditStatus)))]}}])}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[i.auditStatus?e._e():s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onApproval(i)}}},[e._v("审核")]),e._v(" "),s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onDetails(i)}}},[e._v("查看")])]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.meta.pageNo,"page-sizes":[10,20,50,100],"page-size":e.meta.pageSize,total:e.meta.total,layout:"prev, pager, next, jumper, sizes, total"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]),e._v(" "),s("details-dialog",{attrs:{title:e.operType+"新闻",rowObj:e.rowObj,operType:e.operType,visible:e.showDetailsDialog},on:{"update:visible":function(t){e.showDetailsDialog=t}}}),e._v(" "),s("approval-dialog",{attrs:{rowObj:e.rowObj,visible:e.showApprovalDialog},on:{"update:visible":function(t){e.showApprovalDialog=t},submitApprovalForm:e.submitApprovalForm}})],1)};i._withStripped=!0;var r=s(74),a=s.n(r),l=s(23),n=s.n(l),o=s(6),u=s.n(o),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"details-dialog",attrs:{title:e.title,width:"1000px",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.close,open:e.open}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"新闻类型：",prop:"newsType"}},[s("div",{staticClass:"item"},[e._v(e._s(e._f("newsTypeFilter")(e.ruleForm.newsType)))])]),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题：",prop:"newsTitle"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.newsTitle))])]),e._v(" "),s("el-form-item",{attrs:{label:"列表图片：",prop:"newsImg"}},[s("div",{staticClass:"previewPic"},[s("img",{attrs:{src:e.ruleForm.newsImg,alt:""}})]),e._v(" "),s("div",{staticClass:"tips"},[e._v("（尺寸300px*200px）")])]),e._v(" "),s("el-form-item",{attrs:{label:"有效时间段：",prop:"publishTimeEnd"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.publishTimeStart)+" 至 "+e._s(e.ruleForm.publishTimeEnd))])]),e._v(" "),0===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻内容：",prop:"newsContent"}},[s("div",{domProps:{innerHTML:e._s(e.ruleForm.newsContent)}},[e._v(e._s(e.ruleForm.newsContent))])]):e._e(),e._v(" "),1===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻URL：",prop:"newsUrl"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.newsUrl))])]):e._e()],1)],1)],1)};c._withStripped=!0;s(499);var p=s(507),m=s(501),d={name:"DetailsDialog",mixins:[],components:{},props:{title:{type:String,default:"标题"},operType:{type:String,default:"新增"},rowObj:{type:Object,default:function(){}},visible:{type:Boolean,default:!1}},data:function(){return{ruleForm:this.getInitialForm(),isLoading:!1}},created:function(){},mounted:function(){},filters:u()({},p.a),computed:{show:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{getInitialForm:function(){return{newsType:"",newsTitle:"",publishTimeStart:"",publishTimeEnd:"",newsImg:"",createTime:"",newsStatus:"",newsContent:"",newsUrl:""}},close:function(){this.$refs.ruleForm.clearValidate(),this.ruleForm=this.getInitialForm(),this.show=!1},open:function(){var e=this;if("查看"===this.operType){var t={id:this.rowObj.id,platformEnterprise:"1"};m.a.getDetailsNews(t).done((function(t){t.data&&(e.ruleForm=t.data)})).always((function(){e.loading=!1}))}}}},v=(s(913),s(1)),f=Object(v.a)(d,c,[],!1,null,"620279ea",null);f.options.__file="src/views/news-mgr-p/approval-news/components/DetailsDialog/index.vue";var h=f.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"approval-dialog",attrs:{title:e.title,width:"500px",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.close,open:e.open}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"是否通过：",prop:"isPass"}},[s("el-radio-group",{model:{value:e.ruleForm.isPass,callback:function(t){e.$set(e.ruleForm,"isPass",t)},expression:"ruleForm.isPass"}},e._l(e.isPassSet,(function(e,t){return s("el-radio",{key:"isPass"+t,attrs:{label:e.label}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"理由：",prop:"auditRemark"}},[s("el-input",{attrs:{type:"textarea",placeholder:"请填写新闻标题",autocomplete:"off"},model:{value:e.ruleForm.auditRemark,callback:function(t){e.$set(e.ruleForm,"auditRemark",t)},expression:"ruleForm.auditRemark"}})],1)],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("确 定")])],1)],1)],1)};b._withStripped=!0;var w={name:"ApprovalDialog",mixins:[],props:{title:{type:String,default:"审核新闻"},rowObj:{type:Object,default:function(){}},visible:{type:Boolean,default:!1}},data:function(){return{row:{},ruleForm:this.getInitialForm(),isLoading:!1,isPassSet:[{label:"是"},{label:"否"}],rules:{isPass:[{required:!0,message:"请选择是否通过",trigger:"change"}],auditRemark:[{required:!0,message:"请填写理由",trigger:"blur"}]}}},created:function(){},mounted:function(){},filters:{},computed:{show:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{getInitialForm:function(){return{isPass:"是",auditRemark:""}},close:function(){this.$refs.ruleForm.clearValidate(),this.ruleForm=this.getInitialForm(),this.show=!1},open:function(){this.row=u()({},this.rowObj)},confirm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;var s=e.row.id,i=e.ruleForm,r=i.isPass,a={homeNewsId:s+"",auditRemark:i.auditRemark,auditStatus:"是"===r?"1":"2",epId:"123"};e.$emit("submitApprovalForm",a),e.show=!1}))}}},g=(s(914),Object(v.a)(w,b,[],!1,null,"18f23641",null));g.options.__file="src/views/news-mgr-p/approval-news/components/ApprovalDialog/index.vue";var _=g.exports,T=s(520),y=s(519),F={name:"ApprovalNews",mixins:[T.a],components:{DetailsDialog:h,ApprovalDialog:_},props:{},data:function(){return{newsTypeSet:y.d,newsStatusSet:y.c,auditStatusSet:y.a,createTimeSet:y.b,ruleForm:{enterpriseName:"",newsType:"",newsTitle:"",createTime:"",auditStatus:""},rules:{},showDetailsDialog:!1,showApprovalDialog:!1,selection:[]}},mounted:function(){this.fetchData()},filters:u()({},p.a),computed:{},methods:{formatObj:function(e){for(var t=JSON.parse(n()(e||null)),s=0,i=a()(t);s<i.length;s++){var r=i[s];void 0!==t[r]&&null!==t[r]&&""!==t[r]||delete t[r]}return t},fetchData:function(){var e=this;this.loading=!0,m.a.getApprovalList(this.params).done((function(t){e.tableData=t.data})).always((function(){e.loading=!1}))},conditionQuery:function(){var e=u()({},this.params,this.ruleForm);this.params=this.formatObj(e),this.fetchData()},reset:function(){this.$refs.ruleForm.resetFields(),this.conditionQuery()},onApproval:function(e){this.rowObj=e,this.showApprovalDialog=!0},onDetails:function(e){this.operType="查看",this.rowObj=e,this.showDetailsDialog=!0},submitApprovalForm:function(e){var t=this;m.a.approvalNews(e).done((function(e){t.fetchData()})).always((function(){t.loading=!1}))}}},S=(s(915),Object(v.a)(F,i,[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"title-area"},[t("div",{staticClass:"title"},[this._v("新闻列表：")])])}],!1,null,"29097f6c",null));S.options.__file="src/views/news-mgr-p/approval-news/index.vue";t.default=S.exports},932:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("keep-alive",[this.$route.meta.keepAlive?t("wkb-page-nav",{attrs:{showPageName:!1,menuList:this.menu}}):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():t("wkb-page-nav",{attrs:{showPageName:!1,menuList:this.menu}})],1)};i._withStripped=!0;var r=s(6),a=s.n(r),l=s(8),n=s(721),o=s(21),u=s(9),c={name:"NewsMgrP",components:{wkbPageNav:n.a},data:function(){return{menu:[]}},computed:a()({},Object(l.mapState)({contentMenu:function(e){return e.contentModule?e.contentModule.contentMenu:null}})),watch:{contentMenu:{immediate:!0,handler:function(e,t){this.contentMenu&&this.contentMenu.length&&this.assembleBasicMenu()}}},methods:{assembleBasicMenu:function(){var e=u.a.getMenuScopeByIdentifier(this.contentMenu,o.a.dictionary.contentChildMenu.news_mgr_platform);this.menu=e&&e.childMenu}}},p=s(1),m=Object(p.a)(c,i,[],!1,null,null,null);m.options.__file="src/views/news-mgr-p/index.vue";t.default=m.exports}}]);
//# sourceMappingURL=news-mgr-p.5a2020a6.chunk.js.map