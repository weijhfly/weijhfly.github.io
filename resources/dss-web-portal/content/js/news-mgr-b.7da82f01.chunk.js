(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{718:function(e,t,s){},719:function(e,t,s){},720:function(e,t,s){},916:function(e,t,s){"use strict";s(718)},917:function(e,t,s){"use strict";s(719)},918:function(e,t,s){"use strict";s(720)},926:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"news-mgr-b"},[s("div",{staticClass:"query-content"},[s("div",{staticClass:"query"},[s("div",{staticClass:"title"},[e._v("查询：")]),e._v(" "),s("el-form",{ref:"ruleForm",staticClass:"query-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"新闻类型",prop:"newsType"}},[s("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:e.ruleForm.newsType,callback:function(t){e.$set(e.ruleForm,"newsType",t)},expression:"ruleForm.newsType"}},e._l(e.newsTypeSet,(function(e,t){return s("el-option",{key:"newsType-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题",prop:"newsTitle"}},[s("el-input",{attrs:{placeholder:"请输入新闻标题"},model:{value:e.ruleForm.newsTitle,callback:function(t){e.$set(e.ruleForm,"newsTitle",t)},expression:"ruleForm.newsTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"创建时间",prop:"createTime"}},[s("el-select",{attrs:{placeholder:"请选择创建时间"},model:{value:e.ruleForm.createTime,callback:function(t){e.$set(e.ruleForm,"createTime",t)},expression:"ruleForm.createTime"}},e._l(e.createTimeSet,(function(e,t){return s("el-option",{key:"createTime-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻状态",prop:"newsStatus"}},[s("el-select",{attrs:{placeholder:"请选择新闻状态"},model:{value:e.ruleForm.newsStatus,callback:function(t){e.$set(e.ruleForm,"newsStatus",t)},expression:"ruleForm.newsStatus"}},e._l(e.newsStatusSet,(function(e,t){return s("el-option",{key:"newsStatus-"+t,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{staticClass:"btn-area"},[s("el-button",{attrs:{type:"primary"},on:{click:e.conditionQuery}},[e._v("查询")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.reset}},[e._v("重置")])],1)],1)],1),e._v(" "),s("div",{staticClass:"list"},[s("div",{staticClass:"title-area"},[s("div",{staticClass:"title"},[e._v("新闻列表：")]),e._v(" "),s("div",{staticClass:"btns"},[s("el-button",{attrs:{type:"primary"},on:{click:e.onAdd}},[e._v("添加")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.onBatchDel}},[e._v("删除")])],1)]),e._v(" "),s("div",{staticClass:"table-area"},[s("el-table",{ref:"newsTable",staticStyle:{width:"100%"},attrs:{data:e.tableData.data,"max-height":"500"},on:{"selection-change":e.onSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"newsType",label:"新闻类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsTypeFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"newsTitle",label:"新闻标题",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"",label:"有效时间段",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(s.publishTimeStart)+" 至 "+e._s(s.publishTimeEnd))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"createTime",label:"创建时间",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"newsStatus",label:"新闻状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsStatusFilter")(s.newsStatus)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"auditStatus",label:"审核状态",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("auditStatusFilter")(s.auditStatus)))]}}])}),e._v(" "),s("el-table-column",{attrs:{fixed:"right",label:"操作",width:"320"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[1!==a.newsStatus?s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onEdit(a)}}},[e._v("编辑")]):e._e(),e._v(" "),1!==a.newsStatus?s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onDel(a)}}},[e._v("删除")]):e._e(),e._v(" "),2===a.newsStatus?s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onDetails(a)}}},[e._v("查看")]):e._e(),e._v(" "),1===a.newsStatus?s("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(t){return t.preventDefault(),e.onRetract(a)}}},[e._v("撤回")]):e._e()]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.meta.pageNo,"page-sizes":[10,20,50,100],"page-size":e.meta.pageSize,total:e.meta.total,layout:"prev, pager, next, jumper, sizes, total"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])]),e._v(" "),s("div",{staticClass:"query-footer"},[e._v("WakeData , 数字经营专家")]),e._v(" "),s("oper-dialog",{attrs:{title:e.operType+"新闻",rowObj:e.rowObj,operType:e.operType,visible:e.showOperDialog},on:{"update:visible":function(t){e.showOperDialog=t},submitForm:e.submitForm}}),e._v(" "),s("details-dialog",{attrs:{title:e.operType+"新闻",rowObj:e.rowObj,operType:e.operType,visible:e.showDetailsDialog},on:{"update:visible":function(t){e.showDetailsDialog=t}}})],1)};a._withStripped=!0;var l=s(74),i=s.n(l),r=s(23),n=s.n(r),o=s(6),u=s.n(o),c=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"oper-dialog",attrs:{title:e.title,width:"1000px",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.close,open:e.open}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"新闻类型",prop:"newsType"}},[s("el-select",{attrs:{placeholder:"请选择新闻类型"},model:{value:e.ruleForm.newsType,callback:function(t){e.$set(e.ruleForm,"newsType",t)},expression:"ruleForm.newsType"}},e._l(e.newsTypeSet,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题",prop:"newsTitle"}},[s("el-input",{attrs:{placeholder:"请填写新闻标题",autocomplete:"off"},model:{value:e.ruleForm.newsTitle,callback:function(t){e.$set(e.ruleForm,"newsTitle",t)},expression:"ruleForm.newsTitle"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"列表图片",prop:"newsImg"}},[e.ruleForm.newsImg?s("div",{staticClass:"previewPic"},[s("img",{attrs:{src:e.ruleForm.newsImg,alt:""}})]):e._e(),e._v(" "),s("div",{staticClass:"upload-btn",attrs:{type:"primary"},on:{click:function(t){e.showChooseImageDialog=!0}}},[s("span",{staticClass:"plus"},[e._v("+")]),e._v(" "),s("span",{staticClass:"letter"},[e._v("Upload")])]),e._v(" "),s("div",{staticClass:"tips"},[e._v("（建议尺寸300px*200px）")])]),e._v(" "),s("el-form-item",{attrs:{label:"有效时间段",prop:"publishTimeEnd"}},[s("el-date-picker",{attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.onChangeValidTimeZone},model:{value:e.validTimeZone,callback:function(t){e.validTimeZone=t},expression:"validTimeZone"}})],1),e._v(" "),0===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻内容",prop:"newsContent"}},[s("umeditor",{ref:"umeditor",attrs:{id:"111"},model:{value:e.ruleForm.newsContent,callback:function(t){e.$set(e.ruleForm,"newsContent",t)},expression:"ruleForm.newsContent"}})],1):e._e(),e._v(" "),1===e.ruleForm.newsType?s("el-form-item",{staticClass:"newsUrl",attrs:{label:"新闻URL",prop:"newsUrl"}},[s("el-input",{attrs:{placeholder:"请填写新闻URL（仅支持公众号URL）",autocomplete:"off"},model:{value:e.ruleForm.newsUrl,callback:function(t){e.$set(e.ruleForm,"newsUrl",t)},expression:"ruleForm.newsUrl"}})],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small"},on:{click:e.close}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.preview}},[e._v("预 览")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:e.storeAsDraft}},[e._v("存为草稿")]),e._v(" "),s("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.confirm}},[e._v("提 交")])],1)],1),e._v(" "),e.showChooseImageDialog?s("images-picker",{attrs:{visible:e.showChooseImageDialog,multiple:!1,limit:1},on:{"update:visible":function(t){e.showChooseImageDialog=t},cancel:function(t){e.showChooseImageDialog=!1},picked:e.onPickedImage}}):e._e()],1)};c._withStripped=!0;var m=s(499),p=s.n(m),d=s(724),f=s(24),v=s(501),w={newsTypeFilter:function(e){return 0===e?"自建新闻":"新闻链接"},newsStatusFilter:function(e){return 0===e?"草稿":1===e?"已提交":"已发布"},createTimeFilter:function(e){return 0===e?"一星期内":1===e?"一个月内":2===e?"三个月内":"半年内"},auditStatusFilter:function(e){return 0===e?"待审核":1===e?"审核通过":"审核未通过"},delFlagFilter:function(e){return 0===e?"是":"否"}},h=[{value:0,label:"自建新闻"},{value:1,label:"外链新闻"}],b=[{value:0,label:"草稿"},{value:1,label:"已提交"},{value:2,label:"已发布"}],g=[{value:0,label:"待审核"},{value:1,label:"审核通过"},{value:2,label:"审核未通过"}],_=[{value:0,label:"一星期内"},{value:1,label:"一个月内"},{value:2,label:"三个月内"},{value:3,label:"半年内"}],T={name:"OperDialog",mixins:[],components:{umeditor:d.a,ImagesPicker:f.a},props:{title:{type:String,default:"标题"},operType:{type:String,default:"新增"},rowObj:{type:Object,default:function(){}},visible:{type:Boolean,default:!1}},data:function(){return{validTimeZone:[],ruleForm:this.getInitialForm(),isLoading:!1,showChooseImageDialog:!1,businessSet:[{value:1,label:"所属商圈1"},{value:2,label:"所属商圈2"}],projectSet:[{value:1,label:"所属项目1"},{value:2,label:"所属项目2"}],newsTypeSet:h,auditStatusSet:g,createTimeSet:_,rules:{newsType:[{required:!0,message:"请选择新闻类型",trigger:"change"}],newsTitle:[{required:!0,message:"请填写新闻标题",trigger:"blur"}],newsImg:[{required:!0,message:"请选择列表图片",trigger:"change"}],publishTimeEnd:[{required:!0,message:"请选择有效时间段",trigger:"change"}],newsContent:[{required:!0,message:"请编辑新闻内容",trigger:"blur"}],newsUrl:[{required:!0,message:"请填写新闻URL",trigger:"blur"}]}}},created:function(){},mounted:function(){},watch:{"ruleForm.newsType":{immediate:!0,handler:function(e){}}},filters:u()({},w),computed:{show:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{getInitialForm:function(){return{newsType:"",newsTitle:"",newsImg:"",publishTimeStart:"",publishTimeEnd:"",newsContent:"",newsUrl:""}},onChangeValidTimeZone:function(e){var t=new Date(e[0]),s=new Date(e[1]);this.ruleForm.publishTimeStart=p()(t).format("YYYY-MM-DD hh:mm:ss"),this.ruleForm.publishTimeEnd=p()(s).format("YYYY-MM-DD hh:mm:ss")},close:function(){this.$refs.ruleForm.clearValidate(),this.ruleForm=this.getInitialForm(),this.show=!1},open:function(){var e=this;if("修改"===this.operType){var t={id:this.rowObj.id,platformEnterprise:"1"};v.a.getDetailsNews(t).done((function(t){t.data&&(e.ruleForm=t.data);var s=e.ruleForm,a=s.publishTimeStart,l=s.publishTimeEnd,i=new Date(a),r=new Date(l);e.validTimeZone=[i,r]})).always((function(){e.loading=!1}))}},confirm:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.ruleForm.newsStatus=2,e.$emit("submitForm",e.ruleForm),e.show=!1}))},preview:function(){},storeAsDraft:function(){var e=this;this.$refs.ruleForm.validate((function(t){if(!t)return!1;e.ruleForm.newsStatus=0,e.$emit("submitForm",e.ruleForm),e.show=!1}))},onPickedImage:function(e){e&&(this.ruleForm.newsImg=e.imgUrl),this.showChooseImageDialog=!1}}},y=(s(916),s(1)),F=Object(y.a)(T,c,[],!1,null,"7b764ab0",null);F.options.__file="src/views/news-mgr-b/components/OperDialog/index.vue";var S=F.exports,D=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],staticClass:"details-dialog",attrs:{title:e.title,width:"1000px",visible:e.show,"close-on-click-modal":!1},on:{"update:visible":function(t){e.show=t},close:e.close,open:e.open}},[s("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"新闻类型：",prop:"newsType"}},[s("div",{staticClass:"item"},[e._v(e._s(e._f("newsTypeFilter")(e.ruleForm.newsType)))])]),e._v(" "),s("el-form-item",{attrs:{label:"新闻标题：",prop:"newsTitle"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.newsTitle))])]),e._v(" "),s("el-form-item",{attrs:{label:"列表图片：",prop:"newsImg"}},[s("div",{staticClass:"previewPic"},[s("img",{attrs:{src:e.ruleForm.newsImg,alt:""}})]),e._v(" "),s("div",{staticClass:"tips"},[e._v("（尺寸300px*200px）")])]),e._v(" "),s("el-form-item",{attrs:{label:"有效时间段：",prop:"publishTimeEnd"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.publishTimeStart)+" 至 "+e._s(e.ruleForm.publishTimeEnd))])]),e._v(" "),0===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻内容：",prop:"newsContent"}},[s("div",{domProps:{innerHTML:e._s(e.ruleForm.newsContent)}},[e._v(e._s(e.ruleForm.newsContent))])]):e._e(),e._v(" "),1===e.ruleForm.newsType?s("el-form-item",{attrs:{label:"新闻URL：",prop:"newsUrl"}},[s("div",{staticClass:"item"},[e._v(e._s(e.ruleForm.newsUrl))])]):e._e()],1),e._v(" "),s("div",{staticClass:"approvalRecords"},[s("div",{staticClass:"title"},[e._v("审批记录：")]),e._v(" "),s("div",{staticClass:"table-area"},[s("el-table",{ref:"newsTable",staticStyle:{width:"100%"},attrs:{data:e.ruleForm.memHomeNewsAuditDOList,"max-height":"300"}},[s("el-table-column",{attrs:{prop:"newsType",label:"新闻类型",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("newsTypeFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"newsTitle",label:"新闻标题",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"submitTime",label:"提交时间",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"auditTime",label:"审批时间",width:"120"}}),e._v(" "),s("el-table-column",{attrs:{prop:"auditStatus",label:"审批结果",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.row;return[e._v(e._s(e._f("auditStatusFilter")(s.newsType)))]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"auditRemark",label:"理由",width:""}})],1)],1)])],1)],1)};D._withStripped=!0;var C={name:"DetailsDialog",mixins:[],components:{},props:{title:{type:String,default:"标题"},operType:{type:String,default:"新增"},rowObj:{type:Object,default:function(){}},visible:{type:Boolean,default:!1}},data:function(){return{ruleForm:this.getInitialForm(),isLoading:!1,approvalTableData:[{newsType:0,newsTitle:"newsTitle1",submitTime:"2020-10-10",auditTime:"2020-10-10",auditStatus:"auditStatus1",auditRemark:"reason1"},{newsType:1,newsTitle:"newsTitle22",submitTime:"2020-11-11",auditTime:"2020-11-11",auditStatus:"auditStatus22",auditRemark:"reason22"}]}},created:function(){},mounted:function(){},filters:{},computed:{show:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},methods:{getInitialForm:function(){return{newsType:"",newsTitle:"",publishTimeStart:"",publishTimeEnd:"",newsImg:"",createTime:"",newsStatus:"",newsContent:"",newsUrl:"",memHomeNewsAuditDOList:[]}},close:function(){this.$refs.ruleForm.clearValidate(),this.ruleForm=this.getInitialForm(),this.show=!1},open:function(){var e=this;if("查看"===this.operType){var t={id:this.rowObj.id,platformEnterprise:"1"};v.a.getDetailsNews(t).done((function(t){t.data&&(e.ruleForm=t.data)})).always((function(){e.loading=!1}))}}}},k=(s(917),Object(y.a)(C,D,[],!1,null,"efe46af4",null));k.options.__file="src/views/news-mgr-b/components/DetailsDialog/index.vue";var x=k.exports,O={name:"newsMgrB",mixins:[s(520).a],components:{OperDialog:S,DetailsDialog:x},props:{},data:function(){return{newsTypeSet:h,newsStatusSet:b,auditStatusSet:g,createTimeSet:_,ruleForm:{newsType:"",newsTitle:"",createTime:"",newsStatus:""},rules:{},showOperDialog:!1,showDetailsDialog:!1,selection:[]}},mounted:function(){this.fetchData()},filters:u()({},w),computed:{},methods:{formatObj:function(e){for(var t=JSON.parse(n()(e||null)),s=0,a=i()(t);s<a.length;s++){var l=a[s];void 0!==t[l]&&null!==t[l]&&""!==t[l]||delete t[l]}return t},fetchData:function(){var e=this;this.loading=!0,this.params.platformEnterprise="1",v.a.getNewsList(this.params).done((function(t){t.data?e.tableData=t.data:e.tableData.data=[]})).always((function(){e.loading=!1}))},conditionQuery:function(){var e=u()({},this.params,this.ruleForm);this.params=this.formatObj(e),this.fetchData()},reset:function(){this.$refs.ruleForm.resetFields(),this.conditionQuery()},onSelectionChange:function(e){this.selection=e},onAdd:function(){this.operType="新增",this.rowObj=null,this.showOperDialog=!0},onEdit:function(e){this.operType="修改",this.rowObj=e,this.showOperDialog=!0},onBatchDel:function(){var e=this;this.selection.length?this.$confirm("即将删除选中数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t={idList:[]};e.selection.forEach((function(e){t.idList.push(e.id)})),v.a.delNews(t).done((function(t){e.fetchData(),e.$message({type:"success",message:"批量删除成功!"})})).always((function(){}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message.info("请选择至少一条数据")},onDel:function(e){var t=this;this.$confirm("即将删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s={idList:[]};s.idList.push(e.id),v.a.delNews(s).done((function(e){t.fetchData(),t.$message({type:"success",message:"删除成功!"})})).always((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},onDetails:function(e){this.operType="查看",this.rowObj=e,this.showDetailsDialog=!0},onRetract:function(e){var t=this;this.$confirm("即将撤回该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var s={id:e.id};v.a.withdrawNews(s).done((function(e){t.fetchData(),t.$message({type:"success",message:"撤回成功!"})})).always((function(){}))})).catch((function(){t.$message({type:"info",message:"已取消撤回"})}))},submitForm:function(e){var t=this;if("新增"===this.operType){var s=JSON.parse(n()(e));s.platformEnterprise="1",s.epId="123",delete s.businessId,delete s.projectId,v.a.addNews(s).done((function(e){t.fetchData(),t.$message({type:"success",message:"新增成功!"})})).always((function(){}))}else if("修改"===this.operType){var a=JSON.parse(n()(e));a.platformEnterprise="0",a.epId="123",delete a.businessId,delete a.projectId,v.a.updataNews(a).done((function(e){t.fetchData(),t.$message({type:"success",message:"修改成功!"})})).always((function(){}))}}}},$=(s(918),Object(y.a)(O,a,[],!1,null,"2fd41750",null));$.options.__file="src/views/news-mgr-b/index.vue";t.default=$.exports}}]);
//# sourceMappingURL=news-mgr-b.7da82f01.chunk.js.map